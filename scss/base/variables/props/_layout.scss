// Import theme overrides first
@use "../../../theme/" as *;
@import "../../../theme/overrides";

$layout-column-min: 30ch !default;
$layout-gap: min(3vmax, include-prop-fallbacks("space-xl", 1rem)) !default;
// $layout-gap: var(--spacing-gutter);

// Grid layout
$layout-grid-min: include-prop-fallbacks(
  "layout-column-min",
  #{$layout-column-min}
) !default;
$layout-grid-gap: include-prop-fallbacks("layout-gap", #{$layout-gap}) !default;
$layout-grid-template-columns: unquote(
  "repeat(var(--layout-grid-auto-repeat, auto-fit), minmax(min(100%, #{include-prop-fallbacks("layout-column-min", #{$layout-column-min})}), 1fr))"
);

/// Grid layout - define column variation
$column-count: 4 !default;
/* calculations */
$breakpoint: calc(
  var(--layout-grid-min, #{$layout-grid-min}) *
    var(--column-count, #{$column-count}) +
    (
      var(--layout-grid-gap, #{$layout-grid-gap}) *
        (var(--column-count, #{$column-count}) - 1)
    )
);
$column-size: calc(
  (100% / var(--column-count, #{$column-count})) -
    var(--layout-grid-gap, #{$layout-grid-gap})
);

// Flex layout
$flex-grid-min: var(--layout-column-min, #{$layout-column-min}) !default;
$flex-grid-gap: var(--layout-gap, #{$layout-gap}) !default;

$register-layout: (
  "layout-column-min": (
    "syntax": "*",
    "inherits": true,
    "initial-value": #{$layout-column-min},
  ),
  "layout-gap": (
    "syntax": "*",
    "inherits": true,
    "initial-value": calc(clamp(0.25rem, 1vi, 1rem) * 1.42 * 1.42 * 1.42),
  ),
  "layout-grid-min": (
    "syntax": "*",
    "inherits": true,
    "initial-value": #{$layout-column-min},
  ),
  "layout-grid-gap": (
    "syntax": "*",
    "inherits": true,
    "initial-value": calc(clamp(0.25rem, 1vi, 1rem) * 1.42 * 1.42 * 1.42),
  ),
  "layout-grid-template-columns": (
    "syntax": "*",
    "inherits": true,
    "initial-value":
      repeat(auto-fit, minmax(min(100%, #{$layout-column-min}), 1fr)),
  ),
  "column-count": (
    "syntax": "<number>",
    "inherits": true,
    "initial-value": #{$column-count},
  ),
  "breakpoint": (
    "syntax": "*",
    "inherits": true,
    "initial-value":
      calc(
        #{$layout-column-min} * #{$column-count} +
          (
            calc(clamp(0.25rem, 1vi, 1rem) * 1.42 * 1.42 * 1.42) *
              (#{$column-count} - 1)
          )
      ),
  ),
  "column-size": (
    "syntax": "*",
    "inherits": true,
    "initial-value": #{$column-size},
  ),
  "flex-grid-min": (
    "syntax": "*",
    "inherits": true,
    "initial-value": #{$layout-column-min},
  ),
  "flex-grid-gap": (
    "syntax": "*",
    "inherits": true,
    "initial-value": calc(clamp(0.25rem, 1vi, 1rem) * 1.42 * 1.42 * 1.42),
  ),
);
